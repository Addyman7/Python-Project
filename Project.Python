{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c3bbed0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import xlrd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "75e6dbc4",
   "metadata": {},
   "outputs": [],
   "source": [
    "data=pd.read_csv(\"Customer Acqusition.csv\")\n",
    "data1=pd.read_csv(\"Repayment.csv\")\n",
    "data2=pd.read_csv(\"Spend.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "18d49a69",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 100 entries, 0 to 99\n",
      "Data columns (total 8 columns):\n",
      " #   Column               Non-Null Count  Dtype  \n",
      "---  ------               --------------  -----  \n",
      " 0   Sl No:               100 non-null    int64  \n",
      " 1   Customer             100 non-null    object \n",
      " 2   Age                  100 non-null    float64\n",
      " 3   City                 100 non-null    object \n",
      " 4   Credit Card Product  100 non-null    object \n",
      " 5   Limit                100 non-null    object \n",
      " 6   Company              100 non-null    object \n",
      " 7   Segment              100 non-null    object \n",
      "dtypes: float64(1), int64(1), object(6)\n",
      "memory usage: 6.4+ KB\n"
     ]
    }
   ],
   "source": [
    "data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "8850bc12",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1523 entries, 0 to 1522\n",
      "Data columns (total 5 columns):\n",
      " #   Column      Non-Null Count  Dtype  \n",
      "---  ------      --------------  -----  \n",
      " 0   SL No:      1500 non-null   float64\n",
      " 1   Customer    1500 non-null   object \n",
      " 2   Month       1500 non-null   object \n",
      " 3   Repay       1500 non-null   float64\n",
      " 4   Unnamed: 4  0 non-null      float64\n",
      "dtypes: float64(3), object(2)\n",
      "memory usage: 59.6+ KB\n"
     ]
    }
   ],
   "source": [
    "data1.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "3f687255",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1500 entries, 0 to 1499\n",
      "Data columns (total 5 columns):\n",
      " #   Column    Non-Null Count  Dtype \n",
      "---  ------    --------------  ----- \n",
      " 0   Sl No:    1500 non-null   int64 \n",
      " 1   Customer  1500 non-null   object\n",
      " 2   Month     1500 non-null   object\n",
      " 3   Type      1500 non-null   object\n",
      " 4   Amount    1500 non-null   int64 \n",
      "dtypes: int64(2), object(3)\n",
      "memory usage: 58.7+ KB\n"
     ]
    }
   ],
   "source": [
    "data2.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "19bd0831",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['JEWELLERY', 'PETRO', 'CLOTHES', 'FOOD', 'CAMERA', 'SANDALS',\n",
       "       'CAR', 'BIKE', 'AUTO', 'SHOPPING', 'AIR TICKET', 'BUS TICKET',\n",
       "       'TRAIN TICKET', 'RENTAL', 'MOVIE TICKET'], dtype=object)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data2['Type'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "8b3e6fbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "category_mapping = {\n",
    "    'JEWELLERY': 'Luxury',\n",
    "    'PETRO': 'Transportation',\n",
    "    'CLOTHES': 'Apparel',\n",
    "    'FOOD': 'Food & Dining',\n",
    "    'CAMERA': 'Electronics',\n",
    "    'SANDALS': 'Apparel',\n",
    "    'CAR': 'Transportation',\n",
    "    'BIKE': 'Transportation',\n",
    "    'AUTO': 'Transportation',\n",
    "    'SHOPPING': 'Retail',\n",
    "    'AIR TICKET': 'Travel',\n",
    "    'BUS TICKET': 'Travel',\n",
    "    'TRAIN TICKET': 'Travel',\n",
    "    'RENTAL': 'Housing',\n",
    "    'MOVIE TICKET': 'Entertainment'\n",
    "}\n",
    "data2['Category']=data2['Type'].map(category_mapping)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "384ba719",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'JEWELLERY': 'Luxury',\n",
       " 'PETRO': 'Transportation',\n",
       " 'CLOTHES': 'Apparel',\n",
       " 'FOOD': 'Food & Dining',\n",
       " 'CAMERA': 'Electronics',\n",
       " 'SANDALS': 'Apparel',\n",
       " 'CAR': 'Transportation',\n",
       " 'BIKE': 'Transportation',\n",
       " 'AUTO': 'Transportation',\n",
       " 'SHOPPING': 'Retail',\n",
       " 'AIR TICKET': 'Travel',\n",
       " 'BUS TICKET': 'Travel',\n",
       " 'TRAIN TICKET': 'Travel',\n",
       " 'RENTAL': 'Housing',\n",
       " 'MOVIE TICKET': 'Entertainment'}"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "category_mapping"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "a7f0e067",
   "metadata": {},
   "outputs": [],
   "source": [
    "mean_age=data['Age'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f83802d4",
   "metadata": {},
   "outputs": [],
   "source": [
    "data.loc[data['Age']<18,'Age']=mean_age"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "5bcc793e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sl No:</th>\n",
       "      <th>Customer</th>\n",
       "      <th>Age</th>\n",
       "      <th>City</th>\n",
       "      <th>Credit Card Product</th>\n",
       "      <th>Limit</th>\n",
       "      <th>Company</th>\n",
       "      <th>Segment</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>A1</td>\n",
       "      <td>40.146511</td>\n",
       "      <td>BANGALORE</td>\n",
       "      <td>Gold</td>\n",
       "      <td>INR 5,00,000.00</td>\n",
       "      <td>C1</td>\n",
       "      <td>Self Employed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>A2</td>\n",
       "      <td>35.534600</td>\n",
       "      <td>CALCUTTA</td>\n",
       "      <td>Silver</td>\n",
       "      <td>INR 1,00,000.00</td>\n",
       "      <td>C2</td>\n",
       "      <td>Salaried_MNC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>A3</td>\n",
       "      <td>40.146511</td>\n",
       "      <td>COCHIN</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,000.00</td>\n",
       "      <td>C3</td>\n",
       "      <td>Salaried_Pvt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>A4</td>\n",
       "      <td>45.820300</td>\n",
       "      <td>BOMBAY</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,001.00</td>\n",
       "      <td>C4</td>\n",
       "      <td>Govt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>A5</td>\n",
       "      <td>69.663900</td>\n",
       "      <td>BANGALORE</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,002.00</td>\n",
       "      <td>C5</td>\n",
       "      <td>Normal Salary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>96</td>\n",
       "      <td>A96</td>\n",
       "      <td>29.631600</td>\n",
       "      <td>CHENNAI</td>\n",
       "      <td>Silver</td>\n",
       "      <td>INR 1,00,000.00</td>\n",
       "      <td>C19</td>\n",
       "      <td>Salaried_Pvt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>97</td>\n",
       "      <td>A97</td>\n",
       "      <td>20.611800</td>\n",
       "      <td>TRIVANDRUM</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,000.00</td>\n",
       "      <td>C20</td>\n",
       "      <td>Govt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>98</td>\n",
       "      <td>A98</td>\n",
       "      <td>40.539000</td>\n",
       "      <td>CALCUTTA</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,001.00</td>\n",
       "      <td>C21</td>\n",
       "      <td>Normal Salary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>99</td>\n",
       "      <td>A99</td>\n",
       "      <td>21.588700</td>\n",
       "      <td>CALCUTTA</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,002.00</td>\n",
       "      <td>C22</td>\n",
       "      <td>Self Employed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>100</td>\n",
       "      <td>A100</td>\n",
       "      <td>23.607600</td>\n",
       "      <td>COCHIN</td>\n",
       "      <td>Silver</td>\n",
       "      <td>INR 1,00,000.00</td>\n",
       "      <td>C5</td>\n",
       "      <td>Salaried_MNC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Sl No: Customer        Age        City Credit Card Product  \\\n",
       "0        1       A1  40.146511   BANGALORE                Gold   \n",
       "1        2       A2  35.534600    CALCUTTA              Silver   \n",
       "2        3       A3  40.146511      COCHIN            Platimum   \n",
       "3        4       A4  45.820300      BOMBAY            Platimum   \n",
       "4        5       A5  69.663900   BANGALORE            Platimum   \n",
       "..     ...      ...        ...         ...                 ...   \n",
       "95      96      A96  29.631600     CHENNAI              Silver   \n",
       "96      97      A97  20.611800  TRIVANDRUM            Platimum   \n",
       "97      98      A98  40.539000    CALCUTTA            Platimum   \n",
       "98      99      A99  21.588700    CALCUTTA            Platimum   \n",
       "99     100     A100  23.607600      COCHIN              Silver   \n",
       "\n",
       "              Limit Company        Segment  \n",
       "0   INR 5,00,000.00      C1  Self Employed  \n",
       "1   INR 1,00,000.00      C2   Salaried_MNC  \n",
       "2     INR 10,000.00      C3   Salaried_Pvt  \n",
       "3     INR 10,001.00      C4           Govt  \n",
       "4     INR 10,002.00      C5  Normal Salary  \n",
       "..              ...     ...            ...  \n",
       "95  INR 1,00,000.00     C19   Salaried_Pvt  \n",
       "96    INR 10,000.00     C20           Govt  \n",
       "97    INR 10,001.00     C21  Normal Salary  \n",
       "98    INR 10,002.00     C22  Self Employed  \n",
       "99  INR 1,00,000.00      C5   Salaried_MNC  \n",
       "\n",
       "[100 rows x 8 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "9912c407",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Month</th>\n",
       "      <th>2004-01</th>\n",
       "      <th>2004-02</th>\n",
       "      <th>2004-03</th>\n",
       "      <th>2004-04</th>\n",
       "      <th>2004-05</th>\n",
       "      <th>2004-09</th>\n",
       "      <th>2004-11</th>\n",
       "      <th>2005-01</th>\n",
       "      <th>2005-02</th>\n",
       "      <th>2005-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2006-03</th>\n",
       "      <th>2006-04</th>\n",
       "      <th>2006-05</th>\n",
       "      <th>2006-06</th>\n",
       "      <th>2006-07</th>\n",
       "      <th>2006-08</th>\n",
       "      <th>2006-09</th>\n",
       "      <th>2006-10</th>\n",
       "      <th>2006-11</th>\n",
       "      <th>2006-12</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Customer</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>A1</th>\n",
       "      <td>1511173.0</td>\n",
       "      <td>41381.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>131197.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>398404.0</td>\n",
       "      <td>1404194.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>564506.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>220735.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A10</th>\n",
       "      <td>747428.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>435159.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>480729.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>357397.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>233742.0</td>\n",
       "      <td>60213.0</td>\n",
       "      <td>117296.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>267437.0</td>\n",
       "      <td>230894.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A100</th>\n",
       "      <td>42254.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A11</th>\n",
       "      <td>819545.0</td>\n",
       "      <td>501940.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>493104.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>492694.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>148870.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>103940.0</td>\n",
       "      <td>462785.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>92871.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>261662.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A12</th>\n",
       "      <td>744971.0</td>\n",
       "      <td>414392.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>190053.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>287857.0</td>\n",
       "      <td>1208185.0</td>\n",
       "      <td>524412.0</td>\n",
       "      <td>...</td>\n",
       "      <td>877582.0</td>\n",
       "      <td>179585.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>133727.0</td>\n",
       "      <td>347129.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86873.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Month       2004-01   2004-02   2004-03   2004-04   2004-05   2004-09  \\\n",
       "Customer                                                                \n",
       "A1        1511173.0   41381.0       0.0       0.0  131197.0       0.0   \n",
       "A10        747428.0       0.0  435159.0       0.0  480729.0       0.0   \n",
       "A100        42254.0       0.0       0.0       0.0       0.0       0.0   \n",
       "A11        819545.0  501940.0       0.0  493104.0       0.0       0.0   \n",
       "A12        744971.0  414392.0       0.0       0.0       0.0  190053.0   \n",
       "\n",
       "Month     2004-11   2005-01    2005-02   2005-04  ...   2006-03   2006-04  \\\n",
       "Customer                                          ...                       \n",
       "A1            0.0  398404.0  1404194.0       0.0  ...       0.0  564506.0   \n",
       "A10           0.0       0.0   357397.0       0.0  ...  233742.0   60213.0   \n",
       "A100          0.0       0.0        0.0       0.0  ...       0.0       0.0   \n",
       "A11           0.0       0.0   492694.0       0.0  ...  148870.0       0.0   \n",
       "A12           0.0  287857.0  1208185.0  524412.0  ...  877582.0  179585.0   \n",
       "\n",
       "Month      2006-05   2006-06   2006-07   2006-08  2006-09   2006-10   2006-11  \\\n",
       "Customer                                                                        \n",
       "A1             0.0       0.0       0.0       0.0      0.0  220735.0       0.0   \n",
       "A10       117296.0       0.0  267437.0  230894.0      0.0       0.0       0.0   \n",
       "A100           0.0       0.0       0.0       0.0      0.0       0.0       0.0   \n",
       "A11       103940.0  462785.0       0.0       0.0  92871.0       0.0  261662.0   \n",
       "A12            0.0       0.0  133727.0  347129.0      0.0   86873.0       0.0   \n",
       "\n",
       "Month     2006-12  \n",
       "Customer           \n",
       "A1            0.0  \n",
       "A10           0.0  \n",
       "A100          0.0  \n",
       "A11           0.0  \n",
       "A12           0.0  \n",
       "\n",
       "[5 rows x 30 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "monthly_spend = data2.pivot_table(index='Customer', columns='Month', values='Amount', aggfunc='sum')\n",
    "monthly_spend.columns = pd.to_datetime(monthly_spend.columns).to_period('M')\n",
    "monthly_spend = monthly_spend.groupby(pd.PeriodIndex(monthly_spend.columns, freq='M'), axis=1).sum()\n",
    "monthly_spend.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b54563f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sl No:</th>\n",
       "      <th>Customer</th>\n",
       "      <th>Age</th>\n",
       "      <th>City</th>\n",
       "      <th>Credit Card Product</th>\n",
       "      <th>Limit</th>\n",
       "      <th>Company</th>\n",
       "      <th>Segment</th>\n",
       "      <th>2004-01</th>\n",
       "      <th>2004-02</th>\n",
       "      <th>...</th>\n",
       "      <th>2006-03</th>\n",
       "      <th>2006-04</th>\n",
       "      <th>2006-05</th>\n",
       "      <th>2006-06</th>\n",
       "      <th>2006-07</th>\n",
       "      <th>2006-08</th>\n",
       "      <th>2006-09</th>\n",
       "      <th>2006-10</th>\n",
       "      <th>2006-11</th>\n",
       "      <th>2006-12</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>A1</td>\n",
       "      <td>40.146511</td>\n",
       "      <td>BANGALORE</td>\n",
       "      <td>Gold</td>\n",
       "      <td>INR 5,00,000.00</td>\n",
       "      <td>C1</td>\n",
       "      <td>Self Employed</td>\n",
       "      <td>1511173.0</td>\n",
       "      <td>41381.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>564506.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>220735.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>A2</td>\n",
       "      <td>35.534600</td>\n",
       "      <td>CALCUTTA</td>\n",
       "      <td>Silver</td>\n",
       "      <td>INR 1,00,000.00</td>\n",
       "      <td>C2</td>\n",
       "      <td>Salaried_MNC</td>\n",
       "      <td>735264.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>126061.0</td>\n",
       "      <td>442881.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>73294.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>A3</td>\n",
       "      <td>40.146511</td>\n",
       "      <td>COCHIN</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,000.00</td>\n",
       "      <td>C3</td>\n",
       "      <td>Salaried_Pvt</td>\n",
       "      <td>647217.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>18155.0</td>\n",
       "      <td>67041.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>411959.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>A4</td>\n",
       "      <td>45.820300</td>\n",
       "      <td>BOMBAY</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,001.00</td>\n",
       "      <td>C4</td>\n",
       "      <td>Govt</td>\n",
       "      <td>1103216.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>424647.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>332273.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>A5</td>\n",
       "      <td>69.663900</td>\n",
       "      <td>BANGALORE</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,002.00</td>\n",
       "      <td>C5</td>\n",
       "      <td>Normal Salary</td>\n",
       "      <td>861968.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1175483.0</td>\n",
       "      <td>777255.0</td>\n",
       "      <td>204841.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Sl No: Customer        Age       City Credit Card Product            Limit  \\\n",
       "0       1       A1  40.146511  BANGALORE                Gold  INR 5,00,000.00   \n",
       "1       2       A2  35.534600   CALCUTTA              Silver  INR 1,00,000.00   \n",
       "2       3       A3  40.146511     COCHIN            Platimum    INR 10,000.00   \n",
       "3       4       A4  45.820300     BOMBAY            Platimum    INR 10,001.00   \n",
       "4       5       A5  69.663900  BANGALORE            Platimum    INR 10,002.00   \n",
       "\n",
       "  Company        Segment    2004-01  2004-02  ...    2006-03   2006-04  \\\n",
       "0      C1  Self Employed  1511173.0  41381.0  ...        0.0  564506.0   \n",
       "1      C2   Salaried_MNC   735264.0      0.0  ...        0.0  126061.0   \n",
       "2      C3   Salaried_Pvt   647217.0      0.0  ...    18155.0   67041.0   \n",
       "3      C4           Govt  1103216.0      0.0  ...   424647.0       0.0   \n",
       "4      C5  Normal Salary   861968.0      0.0  ...  1175483.0  777255.0   \n",
       "\n",
       "    2006-05  2006-06  2006-07  2006-08  2006-09   2006-10  2006-11   2006-12  \n",
       "0       0.0      0.0      0.0      0.0      0.0  220735.0      0.0       0.0  \n",
       "1  442881.0      0.0      0.0      0.0      0.0       0.0  73294.0       0.0  \n",
       "2       0.0      0.0      0.0      0.0      0.0       0.0      0.0  411959.0  \n",
       "3  332273.0      0.0      0.0      0.0      0.0       0.0      0.0       0.0  \n",
       "4  204841.0      0.0      0.0      0.0      0.0       0.0      0.0       0.0  \n",
       "\n",
       "[5 rows x 38 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "merged_table = data.merge(monthly_spend, left_on='Customer', right_on='Customer')\n",
    "merged_table.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "86dcabb4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Month</th>\n",
       "      <th>2004-01</th>\n",
       "      <th>2004-02</th>\n",
       "      <th>2004-03</th>\n",
       "      <th>2004-04</th>\n",
       "      <th>2004-05</th>\n",
       "      <th>2004-09</th>\n",
       "      <th>2004-11</th>\n",
       "      <th>2005-01</th>\n",
       "      <th>2005-02</th>\n",
       "      <th>2005-04</th>\n",
       "      <th>...</th>\n",
       "      <th>2006-03</th>\n",
       "      <th>2006-04</th>\n",
       "      <th>2006-05</th>\n",
       "      <th>2006-06</th>\n",
       "      <th>2006-07</th>\n",
       "      <th>2006-08</th>\n",
       "      <th>2006-09</th>\n",
       "      <th>2006-10</th>\n",
       "      <th>2006-11</th>\n",
       "      <th>2006-12</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Customer</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>A1</th>\n",
       "      <td>1.362775e+06</td>\n",
       "      <td>191180.0116</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1581.969829</td>\n",
       "      <td>1.199808e+06</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.712733e+05</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>108320.1205</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>17931.39929</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A10</th>\n",
       "      <td>1.149997e+06</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>266929.3785</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>446068.328500</td>\n",
       "      <td>9.101423e+05</td>\n",
       "      <td>279491.6147</td>\n",
       "      <td>...</td>\n",
       "      <td>125956.719040</td>\n",
       "      <td>4.301121e+05</td>\n",
       "      <td>298502.78290</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>427415.08470</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A100</th>\n",
       "      <td>1.511414e+05</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A11</th>\n",
       "      <td>1.052386e+06</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.106038e+06</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>160690.212501</td>\n",
       "      <td>1.135005e+06</td>\n",
       "      <td>424846.39487</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>54897.90719</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>A12</th>\n",
       "      <td>3.686586e+05</td>\n",
       "      <td>243130.4002</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>397648.5597</td>\n",
       "      <td>0.0</td>\n",
       "      <td>258170.492</td>\n",
       "      <td>0.0</td>\n",
       "      <td>29185.273690</td>\n",
       "      <td>1.059845e+06</td>\n",
       "      <td>328164.5473</td>\n",
       "      <td>...</td>\n",
       "      <td>955025.272200</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>418624.51220</td>\n",
       "      <td>451548.9004</td>\n",
       "      <td>594688.68280</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>439421.5657</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Month          2004-01      2004-02      2004-03      2004-04  2004-05  \\\n",
       "Customer                                                                 \n",
       "A1        1.362775e+06  191180.0116       0.0000       0.0000      0.0   \n",
       "A10       1.149997e+06       0.0000  266929.3785       0.0000      0.0   \n",
       "A100      1.511414e+05       0.0000       0.0000       0.0000      0.0   \n",
       "A11       1.052386e+06       0.0000       0.0000       0.0000      0.0   \n",
       "A12       3.686586e+05  243130.4002       0.0000  397648.5597      0.0   \n",
       "\n",
       "Month        2004-09  2004-11        2005-01       2005-02      2005-04  ...  \\\n",
       "Customer                                                                 ...   \n",
       "A1             0.000      0.0    1581.969829  1.199808e+06       0.0000  ...   \n",
       "A10            0.000      0.0  446068.328500  9.101423e+05  279491.6147  ...   \n",
       "A100           0.000      0.0       0.000000  0.000000e+00       0.0000  ...   \n",
       "A11            0.000      0.0       0.000000  1.106038e+06       0.0000  ...   \n",
       "A12       258170.492      0.0   29185.273690  1.059845e+06  328164.5473  ...   \n",
       "\n",
       "Month           2006-03       2006-04       2006-05      2006-06  \\\n",
       "Customer                                                           \n",
       "A1             0.000000  3.712733e+05       0.00000       0.0000   \n",
       "A10       125956.719040  4.301121e+05  298502.78290       0.0000   \n",
       "A100           0.000000  0.000000e+00       0.00000       0.0000   \n",
       "A11       160690.212501  1.135005e+06  424846.39487       0.0000   \n",
       "A12       955025.272200  0.000000e+00  418624.51220  451548.9004   \n",
       "\n",
       "Month          2006-07  2006-08      2006-09      2006-10      2006-11  \\\n",
       "Customer                                                                 \n",
       "A1             0.00000      0.0  108320.1205       0.0000  17931.39929   \n",
       "A10       427415.08470      0.0       0.0000       0.0000      0.00000   \n",
       "A100           0.00000      0.0       0.0000       0.0000      0.00000   \n",
       "A11        54897.90719      0.0       0.0000       0.0000      0.00000   \n",
       "A12       594688.68280      0.0       0.0000  439421.5657      0.00000   \n",
       "\n",
       "Month     2006-12  \n",
       "Customer           \n",
       "A1            0.0  \n",
       "A10           0.0  \n",
       "A100          0.0  \n",
       "A11           0.0  \n",
       "A12           0.0  \n",
       "\n",
       "[5 rows x 30 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "monthly_repayment = data1.pivot_table(index='Customer', columns='Month', values='Repay', aggfunc='sum')\n",
    "monthly_repayment.columns = pd.to_datetime(monthly_repayment.columns).to_period('M')\n",
    "monthly_repayment = monthly_repayment.groupby(pd.PeriodIndex(monthly_repayment.columns, freq='M'), axis=1).sum()\n",
    "monthly_repayment.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3af7f4b3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Sl No:</th>\n",
       "      <th>Customer</th>\n",
       "      <th>Age</th>\n",
       "      <th>City</th>\n",
       "      <th>Credit Card Product</th>\n",
       "      <th>Limit</th>\n",
       "      <th>Company</th>\n",
       "      <th>Segment</th>\n",
       "      <th>2004-01</th>\n",
       "      <th>2004-02</th>\n",
       "      <th>...</th>\n",
       "      <th>2006-03</th>\n",
       "      <th>2006-04</th>\n",
       "      <th>2006-05</th>\n",
       "      <th>2006-06</th>\n",
       "      <th>2006-07</th>\n",
       "      <th>2006-08</th>\n",
       "      <th>2006-09</th>\n",
       "      <th>2006-10</th>\n",
       "      <th>2006-11</th>\n",
       "      <th>2006-12</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>A1</td>\n",
       "      <td>40.146511</td>\n",
       "      <td>BANGALORE</td>\n",
       "      <td>Gold</td>\n",
       "      <td>INR 5,00,000.00</td>\n",
       "      <td>C1</td>\n",
       "      <td>Self Employed</td>\n",
       "      <td>1.362775e+06</td>\n",
       "      <td>191180.0116</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>371273.2744</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>108320.1205</td>\n",
       "      <td>0.000</td>\n",
       "      <td>17931.39929</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>A2</td>\n",
       "      <td>35.534600</td>\n",
       "      <td>CALCUTTA</td>\n",
       "      <td>Silver</td>\n",
       "      <td>INR 1,00,000.00</td>\n",
       "      <td>C2</td>\n",
       "      <td>Salaried_MNC</td>\n",
       "      <td>6.640794e+05</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>346376.7399</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>414752.806</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>A3</td>\n",
       "      <td>40.146511</td>\n",
       "      <td>COCHIN</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,000.00</td>\n",
       "      <td>C3</td>\n",
       "      <td>Salaried_Pvt</td>\n",
       "      <td>1.347209e+05</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>315238.8082</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.000</td>\n",
       "      <td>329095.55790</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>A4</td>\n",
       "      <td>45.820300</td>\n",
       "      <td>BOMBAY</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,001.00</td>\n",
       "      <td>C4</td>\n",
       "      <td>Govt</td>\n",
       "      <td>2.499316e+05</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>181662.2953</td>\n",
       "      <td>493715.4111</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>196563.7558</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>A5</td>\n",
       "      <td>69.663900</td>\n",
       "      <td>BANGALORE</td>\n",
       "      <td>Platimum</td>\n",
       "      <td>INR 10,002.00</td>\n",
       "      <td>C5</td>\n",
       "      <td>Normal Salary</td>\n",
       "      <td>1.802039e+06</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>970251.0741</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>169470.2565</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>0.0000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Sl No: Customer        Age       City Credit Card Product            Limit  \\\n",
       "0       1       A1  40.146511  BANGALORE                Gold  INR 5,00,000.00   \n",
       "1       2       A2  35.534600   CALCUTTA              Silver  INR 1,00,000.00   \n",
       "2       3       A3  40.146511     COCHIN            Platimum    INR 10,000.00   \n",
       "3       4       A4  45.820300     BOMBAY            Platimum    INR 10,001.00   \n",
       "4       5       A5  69.663900  BANGALORE            Platimum    INR 10,002.00   \n",
       "\n",
       "  Company        Segment       2004-01      2004-02  ...      2006-03  \\\n",
       "0      C1  Self Employed  1.362775e+06  191180.0116  ...       0.0000   \n",
       "1      C2   Salaried_MNC  6.640794e+05       0.0000  ...       0.0000   \n",
       "2      C3   Salaried_Pvt  1.347209e+05       0.0000  ...       0.0000   \n",
       "3      C4           Govt  2.499316e+05       0.0000  ...  181662.2953   \n",
       "4      C5  Normal Salary  1.802039e+06       0.0000  ...  970251.0741   \n",
       "\n",
       "       2006-04      2006-05  2006-06  2006-07  2006-08      2006-09  \\\n",
       "0  371273.2744       0.0000      0.0      0.0      0.0  108320.1205   \n",
       "1  346376.7399       0.0000      0.0      0.0      0.0       0.0000   \n",
       "2  315238.8082       0.0000      0.0      0.0      0.0       0.0000   \n",
       "3  493715.4111       0.0000      0.0      0.0      0.0       0.0000   \n",
       "4       0.0000  169470.2565      0.0      0.0      0.0       0.0000   \n",
       "\n",
       "      2006-10       2006-11      2006-12  \n",
       "0       0.000   17931.39929       0.0000  \n",
       "1  414752.806       0.00000       0.0000  \n",
       "2       0.000  329095.55790       0.0000  \n",
       "3       0.000       0.00000  196563.7558  \n",
       "4       0.000       0.00000       0.0000  \n",
       "\n",
       "[5 rows x 38 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_table1 = data.merge(monthly_repayment, left_on='Customer', right_on='Customer')\n",
    "merged_table1.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0da69084",
   "metadata": {},
   "source": [
    "Highest top 10 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4e057ebf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Customer</th>\n",
       "      <th>Repay</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>A22</td>\n",
       "      <td>9.767171e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>A60</td>\n",
       "      <td>9.262032e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>A61</td>\n",
       "      <td>8.807888e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>A40</td>\n",
       "      <td>8.805085e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>A47</td>\n",
       "      <td>8.529826e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>A43</td>\n",
       "      <td>8.458621e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>A48</td>\n",
       "      <td>8.432804e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>A41</td>\n",
       "      <td>8.374046e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>A49</td>\n",
       "      <td>8.259841e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>A45</td>\n",
       "      <td>8.115210e+06</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Customer         Repay\n",
       "0      A22  9.767171e+06\n",
       "1      A60  9.262032e+06\n",
       "2      A61  8.807888e+06\n",
       "3      A40  8.805085e+06\n",
       "4      A47  8.529826e+06\n",
       "5      A43  8.458621e+06\n",
       "6      A48  8.432804e+06\n",
       "7      A41  8.374046e+06\n",
       "8      A49  8.259841e+06\n",
       "9      A45  8.115210e+06"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "top_10_customers = data1.groupby('Customer')['Repay'].sum().nlargest(10).reset_index()\n",
    "top_10_customers"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d320f223",
   "metadata": {},
   "source": [
    "Segmnet"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "ed47657f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Govt'"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "segment_spending = data.groupby('Segment')['Customer'].count()\n",
    "most_spending_segment = segment_spending.idxmax() #idxmax finds the maximum value for the given column\n",
    "most_spending_segment"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ec5704ae",
   "metadata": {},
   "source": [
    "Age Group"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "ad27c460",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'30-45'"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create a new column 'Age Group' without modifying the original 'Age' column\n",
    "data['Age Group'] = pd.cut(data['Age'], bins=[18, 30, 45, 60, float('inf')], labels=[ '18-30', '30-45', '45-60', '60+'], right=False)\n",
    "\n",
    "age_group_spending = data.groupby('Age Group')['Customer'].count()\n",
    "most_spending_age_group = age_group_spending.idxmax()\n",
    "most_spending_age_group"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "cbb05b68",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Create a bar plot of age group spending\n",
    "plt.figure(figsize=(8, 6))\n",
    "age_group_spending.plot(kind='bar')\n",
    "plt.xlabel('Age Group')\n",
    "plt.ylabel('Spending Count')\n",
    "plt.title('Spending Count by Age Group')\n",
    "plt.xticks(rotation=45)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c28c3681",
   "metadata": {},
   "source": [
    "Spending More Category"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "ec5399cb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Travel'"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "category_spending = data2.groupby('Category')['Amount'].sum()\n",
    "most_spending_category = category_spending.idxmax()\n",
    "most_spending_category"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
